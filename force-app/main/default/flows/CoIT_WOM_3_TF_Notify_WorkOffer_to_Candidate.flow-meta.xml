<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Send_Custom_Notification</name>
        <label>Send Custom Notification</label>
        <locationX>649</locationX>
        <locationY>4788</locationY>
        <actionName>customNotificationAction</actionName>
        <actionType>customNotificationAction</actionType>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>customNotifTypeId</name>
            <value>
                <elementReference>Get_Custom_Notif_Type.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientIds</name>
            <value>
                <elementReference>recipientIds</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>title</name>
            <value>
                <stringValue>Nueva Oferta:  {!$Record.ServiceAppointment__r.AppointmentNumber}</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>body</name>
            <value>
                <elementReference>NotificationBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>targetId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>customNotificationAction</nameSegment>
        <offset>0</offset>
    </actionCalls>
    <apiVersion>57.0</apiVersion>
    <areMetricsLoggedToDataCloud>false</areMetricsLoggedToDataCloud>
    <assignments>
        <name>Add_Related_User_Id_to_Recipient_Ids</name>
        <label>Add Related User Id to Recipient Ids</label>
        <locationX>517</locationX>
        <locationY>2916</locationY>
        <assignmentItems>
            <assignToReference>recipientIds</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>$Record.WOM_ServiceResource_User__r.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_ContactAdmin_Collections</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_RelatedAdminUserId_to_RecipientIds</name>
        <label>Add Related Admin User Id to Recipient Ids</label>
        <locationX>497</locationX>
        <locationY>3456</locationY>
        <assignmentItems>
            <assignToReference>RecipientsIdBase</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>V_AdminUserId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_AdminBase_For_Technician</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assignment_Notication_Offers</name>
        <label>Assignment Notication Offers</label>
        <locationX>385</locationX>
        <locationY>4488</locationY>
        <assignmentItems>
            <assignToReference>NotificationBody</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>F_NotificationBody</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Will_the_base_be_notified</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assignment_Notify_Base</name>
        <label>Assignment Notify Base</label>
        <locationX>99</locationX>
        <locationY>600</locationY>
        <assignmentItems>
            <assignToReference>NotifyBase</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Exits_RingDistanceUsed</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assignment_Value_Aceptance_Work_Offer_Details</name>
        <label>Assignment Value  Aceptance Work Offer Details</label>
        <locationX>1419</locationX>
        <locationY>1032</locationY>
        <assignmentItems>
            <assignToReference>WorkOfferDetailsRecord.WOM_Acceptance_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Excluded by Better Offer</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WorkOfferDetailsRecord.WOM_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Overdue</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WorkOfferDetailsRecord.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Other_Work_Offers.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CollectionOtherWorkOffers</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>WorkOfferDetailsRecord</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>OtherNotification</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Other_Work_Offers</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assignment_Value_Others_Aceptance_Work_Offer_Details</name>
        <label>Assignment Value Others Aceptance Work Offer Details</label>
        <locationX>1155</locationX>
        <locationY>1032</locationY>
        <assignmentItems>
            <assignToReference>WorkOfferDetailsRecord.WOM_Acceptance_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Excluded by Better Offer</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WorkOfferDetailsRecord.WOM_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Overdue</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>WorkOfferDetailsRecord.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>CollectionOtherWorkOffers</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>WorkOfferDetailsRecord</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>OtherNotification</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Other_Work_Offers_By_Accepted</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Record_Other_Work_Offer_Details</name>
        <label>Count Record Other Work Offer Details</label>
        <locationX>803</locationX>
        <locationY>600</locationY>
        <assignmentItems>
            <assignToReference>CountOtherOffers</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Other_Work_Offer_For_Service_Resource</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Validate_Others_Offers</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Count_Record_Other_Work_Offer_Details_Best</name>
        <label>Count Record Other Work Offer Details Best</label>
        <locationX>803</locationX>
        <locationY>1824</locationY>
        <assignmentItems>
            <assignToReference>OtherWorkOffersBest</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>Get_Other_Work_Offer_Best_For_Service_Resource</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Exist_Bether_Work_Offers</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Evaluate_AdminBase_For_Technician</name>
        <label>Evaluate if exist Admin Base For Technician</label>
        <locationX>517</locationX>
        <locationY>3132</locationY>
        <defaultConnector>
            <targetReference>Update_WorkOrder_Value</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>AdminBase_For_Technician_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_ContactAdmin_Collections</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_AdminBase_For_Technician</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Evaluate_RingDistanceUsed</name>
        <label>Evaluate Ring Distance Used (Km)</label>
        <locationX>473</locationX>
        <locationY>2532</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>LessThanOrEqual_RingDistanceUsed_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.CoIT_AerealDistance__c</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <elementReference>$Record.WOM_WorkOffer__r.CoIT_RingDistanceUsed__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Related_User_Id_to_Recipient_Ids</targetReference>
            </connector>
            <label>Less Than or Equal Ring Distance Used</label>
        </rules>
    </decisions>
    <decisions>
        <name>Exist_Bether_Work_Offers</name>
        <label>Exist Bether Work Offers</label>
        <locationX>803</locationX>
        <locationY>1932</locationY>
        <defaultConnector>
            <targetReference>Exits_RingDistanceUsed</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OtherWorkOffersBest</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Update_Work_Offer_Record</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Exits_RingDistanceUsed</name>
        <label>Exits Ring Distance Used</label>
        <locationX>517</locationX>
        <locationY>2424</locationY>
        <defaultConnector>
            <targetReference>Add_Related_User_Id_to_Recipient_Ids</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>No_RingDistanceUsed_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.WOM_WorkOffer__r.CoIT_RingDistanceUsed__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Add_Related_User_Id_to_Recipient_Ids</targetReference>
            </connector>
            <label>No</label>
        </rules>
        <rules>
            <name>Yes_RingDistanceUsed_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.WOM_WorkOffer__r.CoIT_RingDistanceUsed__c</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Evaluate_RingDistanceUsed</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Accepted</name>
        <label>Is Accepted ?</label>
        <locationX>1287</locationX>
        <locationY>924</locationY>
        <defaultConnector>
            <targetReference>Assignment_Value_Aceptance_Work_Offer_Details</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>IsAccepted_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Other_Work_Offers.WOM_Acceptance_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Accept</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assignment_Value_Others_Aceptance_Work_Offer_Details</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Notification_Type</name>
        <label>Notification Type</label>
        <locationX>517</locationX>
        <locationY>4380</locationY>
        <defaultConnector>
            <targetReference>Will_the_base_be_notified</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Overdue_Offers</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>OtherNotification</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assignment_Notication_Offers</targetReference>
            </connector>
            <label>Overdue Offers</label>
        </rules>
    </decisions>
    <decisions>
        <name>Only_Notify_Base</name>
        <label>Only Notify Base ?</label>
        <locationX>231</locationX>
        <locationY>492</locationY>
        <defaultConnector>
            <targetReference>Exits_RingDistanceUsed</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Only_Notify_Base_Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Work_Type_Bussines_Behaivor.CoIt_Solo_Se_Notifica_al_Base__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assignment_Notify_Base</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Programmed_or_Only_Notify_Base</name>
        <label>Programmed or Only Notify Base?</label>
        <locationX>517</locationX>
        <locationY>384</locationY>
        <defaultConnector>
            <targetReference>Get_Other_Work_Offer_For_Service_Resource</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Only_Notify_Base_Outcome</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>Get_Work_Type_Bussines_Behaivor.CoIt_Solo_Se_Notifica_al_Base__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Scheduling_Type__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Programmed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Only_Notify_Base</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Validate_Others_Offers</name>
        <label>Validate Others Offers</label>
        <locationX>803</locationX>
        <locationY>708</locationY>
        <defaultConnector>
            <targetReference>Loop_Other_Work_Offers</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>No_Exist_Offers</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>CountOtherOffers</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Other_Work_Offer_Best_For_Service_Resource</targetReference>
            </connector>
            <label>No Exist Offers</label>
        </rules>
    </decisions>
    <decisions>
        <name>Will_the_base_be_notified</name>
        <label>Will the base be notified?</label>
        <locationX>517</locationX>
        <locationY>4680</locationY>
        <defaultConnector>
            <targetReference>Send_Custom_Notification</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>WillTheBaseBeNotified_Outcome</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>NotifyBase</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <label>Yes</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>F_NotificationBody</name>
        <dataType>String</dataType>
        <expression>&quot;Tiene una nueva oferta de Cita de Servicio &quot;  + TEXT({!CountOtherOffers})+  &quot; oferta(s) fueron canceladas &quot;</expression>
    </formulas>
    <interviewLabel>CoIT WOM 3 TF Notify Work Offer to Candidate {!$Flow.CurrentDateTime}</interviewLabel>
    <label>CoIT WOM 3 TF Notify Work Offer to Candidate</label>
    <loops>
        <name>Loop_AdminBase_For_Technician</name>
        <label>Loop Admin Base For Technician</label>
        <locationX>409</locationX>
        <locationY>3240</locationY>
        <collectionReference>Get_ContactAdmin_Collections</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Get_User_For_AdminBase</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_WorkOrder_Value</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Other_Work_Offers</name>
        <label>Loop Other Work Offers</label>
        <locationX>1067</locationX>
        <locationY>816</locationY>
        <collectionReference>Get_Other_Work_Offer_For_Service_Resource</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Is_Accepted</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Update_Other_Work_Offers</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Share_Work_Offer_Details_With_Partner</name>
        <label>Share Work Offer Details With Partner</label>
        <locationX>517</locationX>
        <locationY>3948</locationY>
        <connector>
            <targetReference>Share_Work_Offer_WithPartner</targetReference>
        </connector>
        <inputAssignments>
            <field>AccessLevel</field>
            <value>
                <stringValue>Edit</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ParentId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RowCause</field>
            <value>
                <stringValue>Manual</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UserOrGroupId</field>
            <value>
                <elementReference>V_AdminUserId</elementReference>
            </value>
        </inputAssignments>
        <object>WOM_WorkOfferDetail__Share</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Share_Work_Offer_Details_With_Tecnichian</name>
        <label>Share Work Offer Details With Tecnichian</label>
        <locationX>517</locationX>
        <locationY>4272</locationY>
        <connector>
            <targetReference>Notification_Type</targetReference>
        </connector>
        <inputAssignments>
            <field>AccessLevel</field>
            <value>
                <stringValue>Edit</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ParentId</field>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RowCause</field>
            <value>
                <stringValue>Manual</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UserOrGroupId</field>
            <value>
                <elementReference>$Record.WOM_ServiceResource_User__r.Id</elementReference>
            </value>
        </inputAssignments>
        <object>WOM_WorkOfferDetail__Share</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Share_Work_Offer_With_Tecnichian</name>
        <label>Share Work Offer  With Tecnichian</label>
        <locationX>517</locationX>
        <locationY>4164</locationY>
        <connector>
            <targetReference>Share_Work_Offer_Details_With_Tecnichian</targetReference>
        </connector>
        <inputAssignments>
            <field>AccessLevel</field>
            <value>
                <stringValue>Edit</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ParentId</field>
            <value>
                <elementReference>$Record.WOM_WorkOffer__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RowCause</field>
            <value>
                <stringValue>Manual</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UserOrGroupId</field>
            <value>
                <elementReference>$Record.WOM_ServiceResource_User__r.Id</elementReference>
            </value>
        </inputAssignments>
        <object>WOM_WorkOffer__Share</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordCreates>
        <name>Share_Work_Offer_WithPartner</name>
        <label>Share Work Offer With Partner</label>
        <locationX>517</locationX>
        <locationY>4056</locationY>
        <connector>
            <targetReference>Share_Work_Offer_With_Tecnichian</targetReference>
        </connector>
        <inputAssignments>
            <field>AccessLevel</field>
            <value>
                <stringValue>Edit</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>ParentId</field>
            <value>
                <elementReference>$Record.WOM_WorkOffer__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>RowCause</field>
            <value>
                <stringValue>Manual</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UserOrGroupId</field>
            <value>
                <elementReference>V_AdminUserId</elementReference>
            </value>
        </inputAssignments>
        <object>WOM_WorkOffer__Share</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordCreates>
    <recordLookups>
        <name>Get_ContactAdmin_Collections</name>
        <label>Get Admin Base For Technician</label>
        <locationX>517</locationX>
        <locationY>3024</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Evaluate_AdminBase_For_Technician</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>AccountId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WOM_Service_Resource__r.AccountId</elementReference>
            </value>
        </filters>
        <filters>
            <field>ReportsToId</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Contact</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Custom_Notif_Type</name>
        <label>Get Custom Notif Type</label>
        <locationX>517</locationX>
        <locationY>3840</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Share_Work_Offer_Details_With_Partner</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>CoIT_WOM_Notify_User</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>CustomNotificationType</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Other_Work_Offer_Best_For_Service_Resource</name>
        <label>Get Other Work Offer Best For Service Resource</label>
        <locationX>803</locationX>
        <locationY>1716</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Count_Record_Other_Work_Offer_Details_Best</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND 3 AND (4 OR 5) AND 6 AND 7</filterLogic>
        <filters>
            <field>WOM_Service_Resource__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WOM_Service_Resource__r.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>WOM_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Open</stringValue>
            </value>
        </filters>
        <filters>
            <field>WOM_Grade__c</field>
            <operator>GreaterThanOrEqualTo</operator>
            <value>
                <elementReference>$Record.WOM_Grade__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>WOM_Acceptance_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Accept</stringValue>
            </value>
        </filters>
        <filters>
            <field>WOM_Acceptance_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Pending</stringValue>
            </value>
        </filters>
        <filters>
            <field>Id</field>
            <operator>NotEqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Scheduling_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Emergency</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>WOM_WorkOfferDetail__c</object>
        <sortField>WOM_Grade__c</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Other_Work_Offer_For_Service_Resource</name>
        <label>Get Other Work Offer For Service Resource</label>
        <locationX>803</locationX>
        <locationY>492</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Count_Record_Other_Work_Offer_Details</targetReference>
        </connector>
        <filterLogic>1 AND 2 AND 3 AND 4 AND (5 OR 6) AND 7</filterLogic>
        <filters>
            <field>Id</field>
            <operator>NotEqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>WOM_Service_Resource__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WOM_Service_Resource__r.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>WOM_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Open</stringValue>
            </value>
        </filters>
        <filters>
            <field>WOM_Grade__c</field>
            <operator>LessThanOrEqualTo</operator>
            <value>
                <elementReference>$Record.WOM_Grade__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>WOM_Acceptance_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Accept</stringValue>
            </value>
        </filters>
        <filters>
            <field>WOM_Acceptance_Status__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Pending</stringValue>
            </value>
        </filters>
        <filters>
            <field>Scheduling_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>Emergency</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>WOM_WorkOfferDetail__c</object>
        <sortField>WOM_Grade__c</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_User_For_AdminBase</name>
        <label>Get User For Admin Base</label>
        <locationX>497</locationX>
        <locationY>3348</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Add_RelatedAdminUserId_to_RecipientIds</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ContactId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Loop_AdminBase_For_Technician.Id</elementReference>
            </value>
        </filters>
        <object>User</object>
        <outputAssignments>
            <assignToReference>V_AdminUserId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_Work_Type_Bussines_Behaivor</name>
        <label>Get Work Type Bussines Behaivor</label>
        <locationX>517</locationX>
        <locationY>276</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Programmed_or_Only_Notify_Base</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ServiceTerritory__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ServiceAppointment__r.ServiceTerritory.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Scheduling_Model__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ServiceAppointment__r.CoIT_WOM_Scheduling_Model__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>First_SchedulingPolicy__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ServiceAppointment__r.FSL__Scheduling_Policy_Used__r.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Scheduling_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.ServiceAppointment__r.CoIT_WOM_Scheduling_Type__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Entitlement__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WorkOrder__r.Entitlement.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>WorkType__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.WorkOrder__r.WorkType.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>CoIT_WorkType_BusinessBehaivor__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Other_Work_Offers</name>
        <label>Update Other Work Offers</label>
        <locationX>1067</locationX>
        <locationY>1524</locationY>
        <connector>
            <targetReference>Get_Other_Work_Offer_Best_For_Service_Resource</targetReference>
        </connector>
        <inputReference>CollectionOtherWorkOffers</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Other_Work_Offers_By_Accepted</name>
        <label>Update Other Work Offers By Accepted</label>
        <locationX>1155</locationX>
        <locationY>1140</locationY>
        <inputReference>CollectionOtherWorkOffers</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Work_Offer_Record</name>
        <label>Update Work Offer Record</label>
        <locationX>671</locationX>
        <locationY>2040</locationY>
        <inputAssignments>
            <field>WOM_Acceptance_Status__c</field>
            <value>
                <stringValue>Excluded by Better Offer</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>WOM_Status__c</field>
            <value>
                <stringValue>Overdue</stringValue>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_WorkOrder_Value</name>
        <label>Update Work Offer Values</label>
        <locationX>517</locationX>
        <locationY>3732</locationY>
        <connector>
            <targetReference>Get_Custom_Notif_Type</targetReference>
        </connector>
        <inputAssignments>
            <field>WOM_ServiceResource_AdminUser__c</field>
            <value>
                <elementReference>V_AdminUserId</elementReference>
            </value>
        </inputAssignments>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>50</locationX>
        <locationY>0</locationY>
        <object>WOM_WorkOfferDetail__c</object>
        <recordTriggerType>Create</recordTriggerType>
        <scheduledPaths>
            <connector>
                <targetReference>Get_Work_Type_Bussines_Behaivor</targetReference>
            </connector>
            <pathType>AsyncAfterCommit</pathType>
        </scheduledPaths>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <variables>
        <name>CollectionOtherWorkOffers</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WOM_WorkOfferDetail__c</objectType>
    </variables>
    <variables>
        <name>CountOtherOffers</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>NotificationBody</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <stringValue>Por favor revise la oferta de Cita de Servicio</stringValue>
        </value>
    </variables>
    <variables>
        <name>NotifyBase</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>OtherNotification</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>OtherWorkOffersBest</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>recipientIds</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>RecipientsIdBase</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ResourcePreference_Collection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ResourcePreference</objectType>
    </variables>
    <variables>
        <name>ResourcePreferenceRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ResourcePreference</objectType>
    </variables>
    <variables>
        <name>V_AdminUserId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>V_CountWorkOffersByBase</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>V_CountWorkOffersByNotified</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>0</scale>
    </variables>
    <variables>
        <name>WorkOfferDetailsRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>WOM_WorkOfferDetail__c</objectType>
    </variables>
</Flow>
